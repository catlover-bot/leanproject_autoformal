import Mathlib.Data.Int.Basic

theorem aime_1984_p7
  (f : ℤ → ℤ)
  (h₀ : ∀ n, 1000 ≤ n → f n = n - 3)
  (h₁ : ∀ n, n < 1000 → f n = f (f (n + 5))) :
  f 84 = 997 :=
begin
  have h₂ : ∀ n, 995 ≤ n → f n = n - 3,
  { intros n hn,
    have h₃ : 1000 ≤ n + 5, linarith,
    rw h₀ at h₃,
    rw h₁ n (by linarith),
    rw h₁ (n + 5) (by linarith),
    rw h₃,
    rw h₀ n hn,
    ring },
  have h₄ : f 995 = 992,
  { apply h₂, linarith },
  have h₅ : f 990 = 992,
  { rw h₁ 990, exact h₄, linarith },
  have h₆ : f 985 = 992,
  { rw h₁ 985, exact h₅, linarith },
  have h₇ : f 980 = 992,
  { rw h₁ 980, exact h₆, linarith },
  have h₈ : f 975 = 992,
  { rw h₁ 975, exact h₇, linarith },
  have h₉ : f 970 = 992,
  { rw h₁ 970, exact h₈, linarith },
  have h₁₀ : f 965 = 992,
  { rw h₁ 965, exact h₉, linarith },
  have h₁₁ : f 960 = 992,
  { rw h₁ 960, exact h₁₀, linarith },
  have h₁₂ : f 955 = 992,
  { rw h₁ 955, exact h₁₁, linarith },
  have h₁₃ : f 950 = 992,
  { rw h₁ 950, exact h₁₂, linarith },
  have h₁₄ : f 945 = 992,
  { rw h₁ 945, exact h₁₃, linarith },
  have h₁₅ : f 940 = 992,
  { rw h₁ 940, exact h₁₄, linarith },
  have h₁₆ : f 935 = 992,
  { rw h₁ 935, exact h₁₅, linarith },
  have h₁₇ : f 930 = 992,
  { rw h₁ 930, exact h₁₆, linarith },
  have h₁₈ : f 925 = 992,
  { rw h₁ 925, exact h₁₇, linarith },
  have h₁₉ : f 920 = 992,
  { rw h₁ 920, exact h₁₈, linarith },
  have h₂₀ : f 915 = 992,
  { rw h₁ 915, exact h₁₉, linarith },
  have h₂₁ : f 910 = 992,
  { rw h₁ 910, exact h₂₀, linarith },
  have h₂₂ : f 905 = 992,
  { rw h₁ 905, exact h₂₁, linarith },
  have h₂₃ : f 900 = 992,
  { rw h₁ 900, exact h₂₂, linarith },
  have h₂₄ : f 895 = 992,
  { rw h₁ 895, exact h₂₃, linarith },
  have h₂₅ : f 890 = 992,
  { rw h₁ 890, exact h₂₄, linarith },
  have h₂₆ : f 885 = 992,
  { rw h₁ 885, exact h₂₅, linarith },
  have h₂₇ : f 880 = 992,
  { rw h₁ 880, exact h₂₆, linarith },
  have h₂₈ : f 875 = 992,
  { rw h₁ 875, exact h₂₇, linarith },
  have h₂₉ : f 870 = 992,
  { rw h₁ 870, exact h₂₈, linarith },
  have h₃₀ : f 865 = 992,
  { rw h₁ 865, exact h₂₉, linarith },
  have h₃₁ : f 860 = 992,
  { rw h₁ 860, exact h₃₀, linarith },
  have h₃₂ : f 855 = 992,
  { rw h₁ 855, exact h₃₁, linarith },
  have h₃₃ : f 850 = 992,
  { rw h₁ 850, exact h₃₂, linarith },
  have h₃₄ : f 845 = 992,
  { rw h₁ 845, exact h₃₃, linarith },
  have h₃₅ : f 840 = 992,
  { rw h₁ 840, exact h₃₄, linarith },
  have h₃₆ : f 835 = 992,
  { rw h₁ 835, exact h₃₅, linarith },
  have h₃₇ : f 830 = 992,
  { rw h₁ 830, exact h₃₆, linarith },
  have h₃₈ : f 825 = 992,
  { rw h₁ 825, exact h₃₇, linarith },
  have h₃₉ : f 820 = 992,
  { rw h₁ 820, exact h₃₈, linarith },
  have h₄₀ : f 815 = 992,
  { rw h₁ 815, exact h₃₉, linarith },
  have h₄₁ : f 810 = 992,
  { rw h₁ 810, exact h₄₀, linarith },
  have h₄₂ : f 805 = 992,
  { rw h₁ 805, exact h₄₁, linarith },
  have h₄₃ : f 800 = 992,
  { rw h₁ 800, exact h₄₂, linarith },
  have h₄₄ : f 795 = 992,
  { rw h₁ 795, exact h₄₃, linarith },
  have h₄₅ : f 790 = 992,
  { rw h₁ 790, exact h₄₄, linarith },
  have h₄₆ : f 785 = 992,
  { rw h₁ 785, exact h₄₅, linarith },
  have h₄₇ : f 780 = 992,
  { rw h₁ 780, exact h₄₆, linarith },
  have h₄₈ : f 775 = 992,
  { rw h₁ 775, exact h₄₇, linarith },
  have h₄₉ : f 770 = 992,
  { rw h₁ 770, exact h₄₈, linarith },
  have h₅₀ : f 765 = 992,
  { rw h₁ 765, exact h₄₉, linarith },
  have h₅₁ : f 760 = 992,
  { rw h₁ 760, exact h₅₀, linarith },
  have h₅₂ : f 755 = 992,
  { rw h₁ 755, exact h₅₁, linarith },
  have h₅₃ : f 750 = 992,
  { rw h₁ 750, exact h₅₂, linarith },
  have h₅₄ : f 745 = 992,
  { rw h₁ 745, exact h₅₃, linarith },
  have h₅₅ : f 740 = 992,
  { rw h₁ 740, exact h₅₄, linarith },
  have h₅₆ : f 735 = 992,
  { rw h₁ 735, exact h₅₅, linarith },
  have h₅₇ : f 730 = 992,
  {